pipeline {
    agent any

    stages {
        stage('docker Build') {
            steps {
                sh """
                    cd src/frontend
                    docker build -t arunkarthick34/frontend:latest .
                """
                }
            }
        }
        
        stage('docker Push') {
            steps {
                withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId:'dockerlogin', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD']]) {
                  sh """docker login -u $USERNAME -p $PASSWORD docker.io
                  docker image push arunkarthick34/frontend
                  """
            }
        }
            
        stage('Kubernetes Deployment') {
            steps {
                sh "kubectl rollout restart deployment/frontend -n bank"
            }
        }                
  
    
//     stage('Scan') {
//       steps {
//           sh "cd src/balancereader"
//         withSonarQubeEnv(installationName: 'sonar-qube') { 
//           sh './mvnw clean org.sonarsource.scanner.maven:sonar-maven-plugin:3.9.0.2155:sonar'
//           //  sh "mvn clean install sonar:sonar"
//         }
//       }
//     }
    }
}
